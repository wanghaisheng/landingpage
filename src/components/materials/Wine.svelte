<script>
  import { createEventDispatcher } from 'svelte'
  import { tweened } from 'svelte/motion'
  import { quintIn } from 'svelte/easing'
  export let pour

  let cover
  const dispatch = createEventDispatcher()
  const y = tweened(60, { duration: 500, easing: quintIn })

  $: if (pour) {
    $y = -160
    setTimeout(() => {
      dispatch('poured')
      cover.style.display = 'none'
    }, 900)
  }
</script>
<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 509">
  <path
    transform="translate(0,509) scale(0.05,-0.05)"
    class="liquid"
    d="M1087 8902 c-18 -21 -44 -69 -58 -105 -14 -37 -57 -148 -95 -247
-126 -325 -188 -496 -274 -760 -47 -143 -133 -371 -192 -506 -572 -1312 -414
-1737 846 -2275 189 -80 484 -225 888 -433 595 -308 859 -343 1218 -159 61 31
182 93 270 139 336 174 850 422 1080 522 535 234 625 291 742 474 127 198 228
520 228 727 0 107 -75 345 -325 1031 -28 77 -93 275 -145 440 -51 165 -115
359 -141 430 -26 72 -76 234 -110 360 -77 280 -100 320 -181 320 -110 0 -570
-79 -708 -121 -232 -72 -1043 -154 -1270 -129 -49 6 -220 24 -380 41 -646 68
-775 94 -1144 231 -183 68 -206 70 -249 20z"
  />
  <rect
    x="5"
    y="{$y}"
    width="290"
    height="220"
    rx="50"
    fill="#fff"
    bind:this="{cover}"
  ></rect>
  <path
    transform="translate(0,509) scale(0.05,-0.05)"
    class="glass"
    d="M1228 10150 c-3 -11 -52 -146 -108 -300 -57 -154 -133 -370 -169
-480 -37 -110 -99 -278 -138 -374 -38 -96 -94 -262 -123 -370 -29 -108 -78
-272 -109 -366 -30 -93 -69 -219 -87 -280 -34 -115 -197 -610 -347 -1050 -318
-933 -64 -1592 733 -1903 60 -24 182 -70 270 -103 88 -34 264 -115 390 -181
127 -66 356 -183 510 -261 507 -255 629 -369 753 -702 l63 -170 2 -1280 2
-1280 -52 -110 c-28 -60 -76 -139 -107 -175 l-55 -65 -433 0 c-889 0 -1413
-81 -1638 -252 -148 -114 -21 -262 255 -297 61 -8 185 -27 276 -42 460 -78
2528 -127 3084 -73 891 87 1070 132 1146 287 110 228 -128 279 -1572 336 -742
30 -706 -57 -686 1629 7 604 17 1104 22 1112 5 7 14 80 21 162 40 469 310 708
1309 1160 39 17 138 68 220 114 83 45 231 110 330 145 491 172 793 459 926
879 125 397 98 595 -170 1260 -38 94 -123 337 -188 540 -66 204 -151 465 -190
580 -38 116 -97 296 -131 400 -136 422 -356 1075 -389 1150 -19 44 -50 143
-68 220 -43 180 -57 185 -384 154 -373 -35 -1443 -50 -1777 -25 -389 29 -1382
37 -1391 11z m2192 -36 c446 1 920 9 1054 17 l244 14 13 -57 c37 -163 56 -227
99 -328 26 -60 180 -515 341 -1010 446 -1369 479 -1469 546 -1630 273 -666
300 -888 153 -1300 -140 -393 -447 -670 -914 -823 -69 -22 -243 -101 -386
-174 -143 -74 -291 -148 -330 -166 -680 -310 -986 -545 -1091 -838 -37 -106
-91 -624 -88 -849 2 -88 2 -551 0 -1030 -2 -784 8 -996 49 -1103 45 -116 377
-338 575 -385 119 -28 46 21 -94 63 -82 25 -173 66 -201 90 l-53 45 417 -13
c1019 -32 1532 -100 1574 -208 32 -85 -38 -117 -329 -149 -115 -13 -285 -42
-379 -64 -191 -46 -1427 -79 -1963 -53 -147 7 -429 19 -627 26 -469 17 -1019
63 -1220 103 -88 17 -180 35 -205 40 -102 20 -25 106 165 184 275 114 1060
186 1628 150 222 -14 219 -20 -66 -152 -97 -45 -168 -85 -157 -89 37 -12 352
148 460 235 262 208 266 235 265 1530 -2 1871 -9 1892 -810 2303 -685 352
-848 430 -1070 512 -695 259 -977 617 -979 1245 -1 268 39 422 311 1180 37
106 246 783 357 1160 48 165 108 345 132 400 24 55 86 226 139 380 52 154 133
379 178 500 46 121 87 229 91 241 5 15 218 18 684 11 372 -6 1042 -9 1487 -8z
m-2640 -9845 c661 -142 3422 -191 3904 -68 85 21 184 39 220 40 37 0 138 13
225 29 186 33 197 30 104 -28 -125 -77 -445 -130 -1113 -184 -614 -49 -2576 9
-3080 91 -93 15 -213 34 -266 41 -66 9 -117 31 -160 70 -50 46 -55 56 -24 50
22 -5 108 -23 190 -41z"
  />
</svg>

<style>
  svg {
    width: 400px;
  }
  .liquid {
    fill: var(--wine);
  }
  @media (max-width: 890px) {
    svg {
      width: 360px;
    }
  }
  @media (max-width: 580px) {
    svg {
      width: 300px;
    }
  }
  @media (max-width: 460px) {
    svg {
      width: 240px;
    }
  }
</style>
